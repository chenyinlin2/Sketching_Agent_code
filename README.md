# Sketching_Agent Project Documentation

## Project Introduction

`Sketching_Agent` is a project related to Reinforcement Learning (RL), mainly used for sketch redrawing tasks. The project combines Deep Reinforcement Learning (DRL) and rendering techniques, aiming to achieve high-quality sketch reconstruction tasks with more concise strokes.

## Instructions for Use

### Environment Setup

* [PyTorch](http://pytorch.org/) 1.1.0
* [tensorboardX](https://github.com/lanpa/tensorboard-pytorch/tree/master/tensorboardX)
* [opencv-python](https://pypi.org/project/opencv-python/) 3.4.0

```
pip3 install torch==1.1.0
pip3 install tensorboardX
pip3 install opencv-python
```

### Model Training

Before training the Sketching_Agent model, you need to prepare the renderer and dataset first.

#### Prepare the Dataset

This project uses two public datasets: **MNIST** and **QuickDraw**. Please manually download them from the official website and place them in the specified directory according to the following instructions.

---

##### ðŸŸ¦ MNIST Dataset Download

MNIST is a classic handwritten digit recognition dataset, containing images of 10 digit classes from 0 to 9.

##### ðŸ”— Download Address:

Please download the following four files from Yann LeCun's official website:
ðŸ‘‰ http://yann.lecun.com/exdb/mnist/

##### ðŸ“„ Required Files:

- `train-images-idx3-ubyte.gz`
- `train-labels-idx1-ubyte.gz`
- `t10k-images-idx3-ubyte.gz`
- `t10k-labels-idx1-ubyte.gz`

---

##### ðŸŸ¨ QuickDraw Dataset Download

QuickDraw is a hand-drawn sketch dataset open-sourced by Google, containing 345 categories. Each category is in `.ndjson` file format, recording stroke vector information.

##### ðŸ”— Download Address:

ðŸ‘‰ https://storage.googleapis.com/quickdraw_dataset/full/simplified/

For example, to download the `.ndjson` file of the "cat" category:

```bash
wget https://storage.googleapis.com/quickdraw_dataset/full/simplified/cat.ndjson -P data/quickdraw/
```

#### Training Code

Train the renderer model:

```bash
python train_renderer.py
```

Training the Sketching_Agent using the DDPG method with a Lagrangian operator:

```bash
python train_wgan.py
```

### Model Testing

Use the `test_*.py` files for model testing.
For example, test the quickdraw dataset:

```bash
python test_quickdraw_128.py
```

#### Visualize Results

Use the tools in the `visualization_result` module to visualize the results generated by the model and generate GIFs.
